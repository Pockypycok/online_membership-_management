# ============================================================
#  ONLINE MEMBERSHIP MANAGEMENT SYSTEM - MAKEFILE
#  à¸£à¸­à¸‡à¸£à¸±à¸š Windows / macOS / Linux (à¹ƒà¸Šà¹‰ GCC Compiler)
# ============================================================

CC = gcc
CFLAGS = -std=c11 -Wall -Wextra -O2
SRC = main.c csv_manager.c
OBJ = $(SRC:.c=.o)
TARGET = app.exe
TEST_TARGET = test_unit.exe
TEST_SRC = test_unit.c csv_manager.c

# ------------------------------------------------------------
# 1ï¸âƒ£ à¸„à¸­à¸¡à¹„à¸à¸¥à¹Œà¹à¸¥à¸°à¸£à¸±à¸™à¹‚à¸›à¸£à¹à¸à¸£à¸¡à¸«à¸¥à¸±à¸
# ------------------------------------------------------------
all: $(TARGET)

$(TARGET): $(OBJ)
	$(CC) $(CFLAGS) -o $(TARGET) $(SRC)

run: $(TARGET)
	./$(TARGET)

# ------------------------------------------------------------
# 2ï¸âƒ£ à¸„à¸­à¸¡à¹„à¸à¸¥à¹Œà¹à¸¥à¸°à¸£à¸±à¸™ Unit Test
# ------------------------------------------------------------
test: $(TEST_TARGET)
	./$(TEST_TARGET)

$(TEST_TARGET): $(TEST_SRC)
	$(CC) $(CFLAGS) -o $(TEST_TARGET) $(TEST_SRC)

# ------------------------------------------------------------
# 3ï¸âƒ£ à¸¥à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œà¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§
# ------------------------------------------------------------
clean:
	del /Q *.o *.exe *.tmp *.bak *.csv 2>nul || true
	@echo "âœ… Clean completed."

# ------------------------------------------------------------
# 4ï¸âƒ£ à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œ CSV à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ (à¹ƒà¸Šà¹‰à¸à¸£à¸“à¸µà¹„à¸¡à¹ˆà¸¡à¸µ users.csv)
# ------------------------------------------------------------
init:
	echo user_id,name,service,start_date,duration,expiry_date,status,email,phone,last_updated,checksum > users.csv
	@echo "ğŸ“ Created users.csv file."

# ------------------------------------------------------------
# ğŸ“‹ à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™:
# make          â†’ à¸„à¸­à¸¡à¹„à¸à¸¥à¹Œà¹‚à¸›à¸£à¹à¸à¸£à¸¡à¸«à¸¥à¸±à¸
# make run      â†’ à¸£à¸±à¸™à¹‚à¸›à¸£à¹à¸à¸£à¸¡
# make test     â†’ à¸£à¸±à¸™ Unit Test
# make clean    â†’ à¸¥à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œ build
# make init     â†’ à¸ªà¸£à¹‰à¸²à¸‡ users.csv à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™
# ------------------------------------------------------------

